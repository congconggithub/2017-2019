
{// 加载头部公共文件 }
 <include file="Public:header" />

<link rel="stylesheet" href="__PUBLIC__/admin/css/index.css">
<script type="text/javascript" src="https://gcsoss.oss-cn-shanghai.aliyuncs.com/common/js/echarts.simple.min.js"></script>
<div class="content col-sm-9 col-md-9  col-lg-10">
    <div class="home-wrap">
        <div class="home-wrap-chart">
            <ul class="home-echart-top">
                <li>
                    <span>今日入账金额</span>
                    <span>{$top.totalIncomeToday|number_format=2}</span>
                </li>
                <li>
                    <span>今日销售额</span>
                    <span>{$top.totalSaleToday|number_format=2}</span>
                </li>
                <li>
                    <span>累计销售额</span>
                    <span>{$top.totalSale|number_format=2}</span>
                </li>
                <li>
                    <span>定期存量</span>
                    <span>{$top.regularMoney|number_format=2}</span>
                </li>
                <li>
                    <span>账户存量</span>
                    <span>{$top.regularAccountMoney|number_format=2}</span>
                </li>
                <li>
                    <span>总存量</span>
                    <span>{$top.totalRegularMoney|number_format=2}</span>
                </li>
            </ul>

            <div style="margin-top: 20px;">
                <div class="home-chart home-chart-border home-chart-float ph-main fl">
                    <div class="home-chart-title chart-border">
                        <div class="home-title-top">
                            <div class="home-title-left">销售统计</div>
                            <div class="home-filter">
                                <div>
                                    <ul class="home-filter-time">
                                        <li class="on" name="first" id="first">7天</li>
                                        <li class="" name="second" id="second">30天</li>
                                        <li class="" name="third" id="third">本月</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div id="main" style="width: 620px;height:360px; position: absolute; top: 50px; left: -75px; right: 0px; bottom: 40px;" class="home-charts"></div>
                        <div class="home-shape-right">
                            <div class="home-right-row">
                                <div>今日销售额<p title="{$sale.todaySale}">{$sale.todaySale|number_format=2}</p></div>
                                <div>比昨日<p class="num-positive" title="{$sale.comYes}">{$sale.comYes|number_format=2}</p></div>
                            </div>
                            <div class="home-right-row">
                                <div>本周销售额<p title="{$sale.weekSale}">{$sale.weekSale|number_format=2}</p></div>
                                <div>比上周同期<p class="num-positive" title="{$sale.comWeek}">{$sale.comWeek|number_format=2}</p></div>
                            </div>
                            <div class="home-right-row">
                                <div>本月销售额<p title="{$sale.thisMonthSale}">{$sale.thisMonthSale|number_format=2}</p></div>
                                <div>比上月同期<p class="num-positive" title="{$sale.comMonth}">{$sale.comMonth|number_format=2}</p></div>
                            </div>
                        </div>
                        <div class="home-shape-bottom">
                            <span class="bom-text">来自银行卡的投资金额：<span id="fromBank"></span></span>
                            <span class="bom-text">来自账户的投资金额：<span id="fromAccount"></span></span>
                        </div>
                    </div>
                </div>
                <div class="home-chart home-chart-border home-chart-float ph-main fl">
                    <div class="home-chart-title chart-border">
                        <div class="home-title-top">
                            <div class="home-title-left">入账统计</div>
                            <div class="home-filter">
                                <div>
                                    <ul class="home-filter-time">
                                        <li class="on" name="first" id="booked-first">7天</li>
                                        <li class="" name="second" id="booked-second">30天</li>
                                        <li class="" name="third" id="booked-third">本月</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div id="main-booked" style="width: 620px;height:360px; position: absolute; top: 50px; left: -80px; right: 0px; bottom: 40px;" class="home-charts"></div>
                        <div class="home-shape-right">
                            <div class="home-right-row">
                                <div>今日入账<p title="{$income.totalIncomeToday}">{$income.totalIncomeToday|number_format=2}</p></div>
                                <div>比昨日<p class="num-positive" title="{$income.comYes}">{$income.comYes|number_format=2}</p></div>
                            </div>
                            <div class="home-right-row">
                                <div>本周入账<p title="{$income.totalIncomeWeek}">{$income.totalIncomeWeek|number_format=2}</p></div>
                                <div>比上周同期<p class="num-positive" title="{$income.comWeek}">{$income.comWeek|number_format=2}</p></div>
                            </div>
                            <div class="home-right-row">
                                <div>本月入账<p title="{$income.totalIncomeMonth}">{$income.totalIncomeMonth|number_format=2}</p></div>
                                <div>比上月同期<p class="num-positive" title="{$income.comMonth}">{$income.comMonth|number_format=2}</p></div>
                            </div>
                        </div>
                        <div class="home-shape-bottom">
                            <span class="bom-text">从银行卡充值到账户金额：<span id="toAccount"></span></span>
                            <span class="bom-text">从银行卡直接购买产品金额：<span id="toProduct"></span></span>
                        </div>
                    </div>
                </div>

                <div class="home-chart home-chart-border home-chart-float ph-main fl">
                    <div class="home-chart-title chart-border">
                        <div class="home-title-top">
                            <div class="home-title-left">还款统计</div>
                            <div class="home-filter">
                                <div>
                                    <ul class="home-filter-time">
                                        <li class="on" name="first" id="backed-first">7天</li>
                                        <li class="" name="second" id="backed-second">30天</li>
                                        <li class="" name="third" id="backed-third">本月</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div id="main-backed" style="width: 620px;height:360px; position: absolute; top: 50px; left: -80px; right: 0px; bottom: 40px;" class="home-charts"></div>
                        <div class="home-shape-right">
                            <div class="home-right-row">
                                <div>今日已还款<p title="{$repay.todayRepay}">{$repay.todayRepay|number_format=2}</p></div>
                                <div>比昨日<p class="num-positive" title="{$repay.comYes}">{$repay.comYes|number_format=2}</p></div>
                            </div>
                            <div class="home-right-row">
                                <div>本周已还款<p title="{$repay.weekRepay}">{$repay.weekRepay|number_format=2}</p></div>
                                <div>比上周同期<p class="num-positive" title="{$repay.comWeek}">{$repay.comWeek|number_format=2}</p></div>
                            </div>
                            <div class="home-right-row">
                                <div>本月已还款<p title="{$repay.thisMonthRepay}">{$repay.thisMonthRepay|number_format=2}</p></div>
                                <div>比上月同期<p class="num-positive" title="{$repay.comMonth}">{$repay.comMonth|number_format=2}</p></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="home-chart home-chart-border home-chart-float ph-main fl">
                    <div class="home-chart-title chart-border">
                        <div class="home-title-top">
                            <div class="home-title-left">提现统计</div>
                            <div class="home-filter">
                                <div>
                                    <ul class="home-filter-time">
                                        <li class="on" name="first" id="drawal-first">7天</li>
                                        <li class="" name="second" id="drawal-second">30天</li>
                                        <li class="" name="third" id="drawal-third">本月</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div id="main-drawal" style="width: 620px;height:360px; position: absolute; top: 50px; left: -80px; right: 0px; bottom: 40px;" class="home-charts"></div>
                        <div class="home-shape-right">
                            <div class="home-right-row">
                                <div>今日提现额<p title="{$withdraw.todayWithdraw}">{$withdraw.todayWithdraw|number_format=2}</p></div>
                                <div>比昨日<p class="num-positive" title="{$withdraw.comYes}">{$withdraw.comYes|number_format=2}</p></div>
                            </div>
                            <div class="home-right-row">
                                <div>本周提现额<p title="{$withdraw.weekWithdraw}">{$withdraw.weekWithdraw|number_format=2}</p></div>
                                <div>比上周同期<p class="num-positive" title="{$withdraw.comWeek}">{$withdraw.comWeek|number_format=2}</p></div>
                            </div>
                            <div class="home-right-row">
                                <div>本月提现额<p title="{$withdraw.thisMonthWithdraw}">{$withdraw.thisMonthWithdraw|number_format=2}</p></div>
                                <div>比上月同期<p class="num-positive" title="{$withdraw.comMonth}">{$withdraw.comMonth|number_format=2}</p></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
<script>
    $(function(){
        $(document).on('click','.home-filter-time li', function(){
            $(this).addClass('on').siblings('li').removeClass('on');
        });
        sales();
        booked();
        backed();
        drawal();
    });
    function sales (){
        var myChart1 = echarts.init(document.getElementById('main'));
        option = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                }
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: []
            },
            yAxis: {
                type: 'value'
            },
            series: [{
                name: '销量',
                data: [],
                type: 'line'
            }]
        };
        myChart1.setOption(option,true);
        function data(msg){
            $.ajax({
                url: ROOT + '/public/sale_data',
                type: 'post',
                data: {day:msg},
                success:function(res){
                    if (res.state == 30001){
                        // console.log(res.data.timelist);
                        myChart1.setOption({
                            xAxis: {
                                data: res.data.timelist
                            },
                            series: [{
                                name: '销量',
                                data: res.data.datalist
                            }]
                        });
                        var fromBank = decimal(res.data.fromBank, 2);
                        var fromAccount = decimal(res.data.fromAccount, 2);
                        $('#fromBank').html(fromBank);
                        $('#fromAccount').html(fromAccount);
                    }else{
                        alert(res.msg);
                    }
                }
            });
        };
        data(7);
        $(document).on('click','#first', function(){
            data(7);
        });
        $(document).on('click','#second', function(){
            data(30);
        });
        $(document).on('click','#third', function(){
            data(1);
        });
    }
    function booked(){
        var myChart2 = echarts.init(document.getElementById('main-booked'));
        option1 = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                }
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: []
            },
            yAxis: {
                type: 'value'
            },
            series: [{
                name: '入账',
                data: [],
                type: 'line'
            }]
        };
        myChart2.setOption(option1,true);
        function bookedMsg(msg){
            $.ajax({
                url: ROOT + '/public/income_data',
                type: 'post',
                data: {day:msg},
                success:function(res){
                    // console.log(res.data);
                    if (res.state == 30001){
                        myChart2.setOption({
                            xAxis: {
                                data: res.data.timelist
                            },
                            series: [{
                                name: '入账',
                                data: res.data.datalist
                            }]
                        });
                        var toAccount = decimal(res.data.toAccount, 2);
                        var toProduct = decimal(res.data.toProduct, 2);
                        $('#toAccount').html(toAccount);
                        $('#toProduct').html(toProduct);
                    }else{
                        alert(res.msg);
                    }
                }
            });
        }
        bookedMsg(7);
        $(document).on('click','#booked-first', function(){
            bookedMsg(7);
        });
        $(document).on('click','#booked-second', function(){
            bookedMsg(30);
        });
        $(document).on('click','#booked-third', function(){
            bookedMsg(1);
        });
    }

    function backed(){
        var myChart3 = echarts.init(document.getElementById('main-backed'));
        option1 = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                }
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: []
            },
            yAxis: {
                type: 'value'
            },
            series: [{
                name: '还款',
                data: [],
                type: 'line'
            }]
        };
        myChart3.setOption(option1,true);
        function backedMsg(msg){
            $.ajax({
                url: ROOT + '/public/repay_data',
                type: 'post',
                data: {day:msg},
                success:function(res){
                    if (res.state == 30001){

                        myChart3.setOption({
                            xAxis: {
                                data: res.data.timelist
                            },
                            series: [{
                                name: '还款',
                                data: res.data.datalist
                            }]
                        });
                    }else{
                        alert(res.msg);
                    }
                }
            });
        }
        backedMsg(7);
        $(document).on('click','#backed-first', function(){
            backedMsg(7);
        });
        $(document).on('click','#backed-second', function(){
            backedMsg(30);
        });
        $(document).on('click','#backed-third', function(){
            backedMsg(1);
        });
    }

    function drawal(){
        var myChart4 = echarts.init(document.getElementById('main-drawal'));
        option1 = {
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross'
                }
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: []
            },
            yAxis: {
                type: 'value'
            },
            series: [{
                name: '提现',
                data: [],
                type: 'line'
            }]
        };
        myChart4.setOption(option1,true);
        function drawalMsg(msg){
            $.ajax({
                url: ROOT + '/public/withdraw_data',
                type: 'post',
                data: {day:msg},
                success:function(res){
                    if (res.state == 30001){

                        myChart4.setOption({
                            xAxis: {
                                data: res.data.timelist
                            },
                            series: [{
                                name: '提现',
                                data: res.data.datalist
                            }]
                        });
                    }else{
                        alert(res.msg);
                    }
                }
            });
        }
        drawalMsg(7);
        $(document).on('click','#drawal-first', function(){
            drawalMsg(7);
        });
        $(document).on('click','#drawal-second', function(){
            drawalMsg(30);
        });
        $(document).on('click','#drawal-third', function(){
            drawalMsg(1);
        });
    }

    function decimal(s, n){
        // s:传入的float数字 ，n:希望返回小数点几位
        n = n > 0 && n <= 20 ? n : 2;
        s = parseFloat((s + "").replace(/[^\d\.-]/g, "")).toFixed(n) + ""
        var l = s.split(".")[0].split("").reverse(), r = s.split(".")[1]
        var t = ""
        for (var i = 0; i < l.length; i++) {
            t += l[i] + ((i + 1) % 3 == 0 && (i + 1) != l.length ? "," : "")
        }
        return t.split("").reverse().join("") + "." + r
    }

</script>
&lt;!&ndash; 主页面结束 &ndash;&gt;
{// 加载尾部公共文件 }
<include file="Public:footer" />

